<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · Pools.jl</title><meta name="title" content="API · Pools.jl"/><meta property="og:title" content="API · Pools.jl"/><meta property="twitter:title" content="API · Pools.jl"/><meta name="description" content="Documentation for Pools.jl."/><meta property="og:description" content="Documentation for Pools.jl."/><meta property="twitter:description" content="Documentation for Pools.jl."/><meta property="og:url" content="https://AbrJA.github.io/Pools.jl/api.html"/><meta property="twitter:url" content="https://AbrJA.github.io/Pools.jl/api.html"/><link rel="canonical" href="https://AbrJA.github.io/Pools.jl/api.html"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">Pools.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Introduction</a></li><li><a class="tocitem" href="usage.html">Usage</a></li><li><a class="tocitem" href="examples.html">Examples</a></li><li class="is-active"><a class="tocitem" href="api.html">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="api.html">API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="api.html">API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/AbrJA/Pools.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/AbrJA/Pools.jl/blob/(unknown)/docs/src/api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Pools.Pool" href="#Pools.Pool"><code>Pools.Pool</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Pool{T}(limit::Int)</p><p>A thread-safe resource pool manager for resources of type <code>T</code>.</p><p>This struct implements a resource pool, managing the acquisition and release of resources with a maximum concurrency limit.  It&#39;s designed to be used with various resource types, such as database connections, file handles, or other objects that need to be managed and reused efficiently.</p><p><strong>Type Parameters</strong></p><ul><li><code>T</code>: The type of resource managed by the pool.</li></ul><p><strong>Fields</strong></p><ul><li><code>limit::Int</code>: The maximum number of resources that can be in use concurrently.</li><li><code>free::Vector{T}</code>: A vector containing the currently available (free) resources in the pool. Resources are typically stored and retrieved in a FIFO (First-In, First-Out) manner.</li><li><code>taken::Set{T}</code>: A set containing the resources that are currently in use (taken) by users.</li><li><code>lock::ReentrantLock</code>: A reentrant lock used for thread safety.  All operations on the pool are protected by this lock.</li><li><code>condition::Threads.Condition</code>: A condition variable used to notify waiting tasks when a resource becomes available.</li></ul><p><strong>Constructor</strong></p><pre><code class="language-julia hljs">Pool{T}(limit::Int) where T
Creates a new resource pool for resources of type T with a maximum concurrency limit of limit.

# Arguments
limit::Int: The maximum number of resources allowed in the pool. Must be a positive integer.

# Throws
ArgumentError: If limit is not a positive integer.

# Example
</code></pre><p>julia using Pools, Redis, Dates</p><p>struct Connection     client::RedisConnection     timestamp::DateTime end</p><p>pool = Pool{Connection}(3) ```</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AbrJA/Pools.jl/blob/77ceaffae95bac187384efe9d8121517786757f1/src/Pools.jl#L148-L191">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Pools.acquire!-Union{Tuple{Pool{T}}, Tuple{T}} where T" href="#Pools.acquire!-Union{Tuple{Pool{T}}, Tuple{T}} where T"><code>Pools.acquire!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>acquire!(pool::Pool{T}) where T -&gt; T</p><p>Acquire a resource from the pool.</p><p>This function attempts to retrieve a resource from the pool.  It will reuse valid cached resources if available, create new resources if the pool is below its limit, or block until a resource becomes available if the pool is at its limit and no valid cached resources are available.</p><p><strong>Arguments</strong></p><ul><li><code>pool::Pool{T}</code>: The resource pool to acquire from.</li></ul><p><strong>Returns</strong></p><p>A resource of type <code>T</code>.</p><p><strong>Throws</strong></p><ul><li><code>MethodError</code>: If the <code>create(::Type{T})</code> function is not implemented for the resource type <code>T</code>.  This function is essential for the <code>Pool</code> to create new resources when needed.  See the documentation for <code>create</code> for more details.</li><li>Exceptions thrown by the <code>validate(resource::T)</code> function. If <code>validate</code> throws an exception, the resource is considered invalid and discarded.</li></ul><p><strong>Thread Safety</strong></p><p>This operation is thread-safe.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">using Redis, Dates

struct Connection
    client::RedisConnection
    timestamp::DateTime
end

create(::Type{Connection}) = Connection(RedisConnection(host = &quot;localhost&quot;, port = 6379, db = 3), now())
validate(redis::Connection) = ping(redis.client)

pool = Pool{Connection}(3)
conn = acquire!(pool)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AbrJA/Pools.jl/blob/77ceaffae95bac187384efe9d8121517786757f1/src/Pools.jl#L319-L359">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Pools.create-Union{Tuple{Type{T}}, Tuple{T}} where T" href="#Pools.create-Union{Tuple{Type{T}}, Tuple{T}} where T"><code>Pools.create</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>create(::Type{T}) where T -&gt; T</p><p>Create a new resource of type <code>T</code>.</p><p>This function is called automatically by the pool when a new resource is needed (e.g., when a resource is acquired and the pool is empty or below its limit).  You <em>must</em> implement this method for any type <code>T</code> that you want to store in a <code>Pool</code>.</p><p><strong>Arguments</strong></p><ul><li><code>::Type{T}</code>: The type of the resource to create.  This is a type parameter, not an instance of the type.</li></ul><p><strong>Returns</strong></p><p>A new resource of type <code>T</code>.</p><p><strong>Throws</strong></p><ul><li><code>MethodError</code>: If this function is not implemented for the given type <code>T</code>.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">
using Pools, Redis, Dates
import Pools: create

struct Connection
    client::RedisConnection
    timestamp::DateTime
end

create(::Type{Connection}) = Connection(RedisConnection(host = &quot;localhost&quot;, port = 6379, db = 3), now())</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AbrJA/Pools.jl/blob/77ceaffae95bac187384efe9d8121517786757f1/src/Pools.jl#L6-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Pools.drain!-Union{Tuple{Pool{T}}, Tuple{T}} where T" href="#Pools.drain!-Union{Tuple{Pool{T}}, Tuple{T}} where T"><code>Pools.drain!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>drain!(pool::Pool{T}) where T</p><p>Drain the resource pool, releasing and finalizing all resources.</p><p>This function releases all resources currently held by the pool, both free and taken. It waits for all taken resources to be released back to the pool before finalizing them. This is typically used when you want to shut down the pool or when you need to ensure that all resources are properly cleaned up.</p><p><strong>Arguments</strong></p><ul><li><code>pool::Pool{T}</code>: The resource pool to drain.</li></ul><p><strong>Thread Safety</strong></p><p>This operation is thread-safe.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">using Redis, Dates

struct Connection
    client::RedisConnection
    timestamp::DateTime
end

create(::Type{Connection}) = Connection(RedisConnection(host = &quot;localhost&quot;, port = 6379, db = 3), now())
finalize!(redis::Connection) = Redis.disconnect(redis.client)

pool = Pool{Connection}(3)

withresource(pool) do redis
    ping(redis.client)
end

drain!(pool)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AbrJA/Pools.jl/blob/77ceaffae95bac187384efe9d8121517786757f1/src/Pools.jl#L486-L522">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Pools.finalize!-Tuple{T} where T" href="#Pools.finalize!-Tuple{T} where T"><code>Pools.finalize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>finalize!(resource::T) where T</p><p>Clean up resources associated with a resource of type <code>T</code>.</p><p>This function is called automatically by the pool in the following situations:</p><ul><li>When a resource fails validation (as determined by the <code>validate</code> function).</li><li>When a resource is removed from the pool (e.g., during pool draining or when the pool&#39;s limit is reduced).</li></ul><p>You <em>should</em> implement this method to release any external resources held by the resource (e.g., closing connections, freeing memory, etc.).  If you do not implement this method, the default implementation will do nothing.</p><p><strong>Arguments</strong></p><ul><li><code>resource::T</code>: The resource to finalize.</li></ul><p><strong>Generic Method</strong></p><p>A generic <code>finalize!(::T) where T</code> method is provided, which does nothing.  This serves as a default implementation so that if you do not define a specific <code>finalize!</code> method for your resource type, no error will be thrown.  However, it is <em>strongly recommended</em> that you implement a specific <code>finalize!</code> method if your resource requires any cleanup.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">using Pools, Redis, Dates
import Pools: create, finalize!

struct Connection
    client::RedisConnection
    timestamp::DateTime
end

function finalize!(redis::Connection)
    Redis.disconnect(redis.client)
end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AbrJA/Pools.jl/blob/77ceaffae95bac187384efe9d8121517786757f1/src/Pools.jl#L42-L77">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Pools.free-Union{Tuple{Pool{T}}, Tuple{T}} where T" href="#Pools.free-Union{Tuple{Pool{T}}, Tuple{T}} where T"><code>Pools.free</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>free(pool::Pool{T}) where T -&gt; Int</p><p>Return the number of free resources currently available in the pool.</p><p>This function provides a thread-safe way to check how many resources are currently available for immediate acquisition in the pool. It does <em>not</em> include resources that are currently in use (taken).</p><p><strong>Arguments</strong></p><ul><li><code>pool::Pool{T}</code>: The resource pool to query.</li></ul><p><strong>Returns</strong></p><p>The number of free resources in the pool.</p><p><strong>Thread Safety</strong></p><p>This operation is thread-safe.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">using Pools

create(::Type{Int}) = rand(1:10)

pool = Pool{Int}(3)
free(pool)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AbrJA/Pools.jl/blob/77ceaffae95bac187384efe9d8121517786757f1/src/Pools.jl#L213-L242">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Pools.limit-Union{Tuple{Pool{T}}, Tuple{T}} where T" href="#Pools.limit-Union{Tuple{Pool{T}}, Tuple{T}} where T"><code>Pools.limit</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>limit(pool::Pool{T}) where T -&gt; Int</p><p>Return the maximum number of resources that the pool can hold concurrently.</p><p>This function returns the <code>limit</code> of the pool, which represents the maximum number of resources that can be in use (taken) at any given time.</p><p><strong>Arguments</strong></p><ul><li><code>pool::Pool{T}</code>: The resource pool to query.</li></ul><p><strong>Returns</strong></p><p>The maximum number of concurrent resources allowed by the pool.</p><p><strong>Thread Safety</strong></p><p>This operation is thread-safe.  Access to the <code>pool.limit</code> field is inherently atomic in Julia.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">using Pools

create(::Type{Int}) = rand(1:10)

pool = Pool{Int}(5)
limit(pool)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AbrJA/Pools.jl/blob/77ceaffae95bac187384efe9d8121517786757f1/src/Pools.jl#L285-L314">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Pools.release!-Union{Tuple{T}, Tuple{Pool{T}, T}} where T" href="#Pools.release!-Union{Tuple{T}, Tuple{Pool{T}, T}} where T"><code>Pools.release!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>release!(pool::Pool{T}, resource::T) where T</p><p>Release a resource back to the pool.</p><p>This function returns a resource to the pool, making it available for reuse.  It updates the resource&#39;s state (using the <code>update!</code> function) and notifies any waiting tasks that a resource has become available.</p><p><strong>Arguments</strong></p><ul><li><code>pool::Pool{T}</code>: The resource pool to release the resource to.</li><li><code>resource::T</code>: The resource to release.</li></ul><p><strong>Throws</strong></p><ul><li><code>ArgumentError</code>: If the provided <code>resource</code> does not belong to the pool (i.e., it was not acquired from this pool).</li><li>Exceptions thrown by the <code>update!(resource::T)</code> function.</li></ul><p><strong>Thread Safety</strong></p><p>This operation is thread-safe.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">using Redis, Dates

struct Connection
    client::RedisConnection
    timestamp::DateTime
end

create(::Type{Connection}) = Connection(RedisConnection(host = &quot;localhost&quot;, port = 6379, db = 3), now())
update!(redis::Connection) = redis.timestamp = now()

pool = Pool{Connection}(3)
conn = acquire!(pool)
release!(pool, conn)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AbrJA/Pools.jl/blob/77ceaffae95bac187384efe9d8121517786757f1/src/Pools.jl#L384-L422">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Pools.taken-Union{Tuple{Pool{T}}, Tuple{T}} where T" href="#Pools.taken-Union{Tuple{Pool{T}}, Tuple{T}} where T"><code>Pools.taken</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>taken(pool::Pool{T}) where T -&gt; Int</p><p>Return the number of resources currently taken (in use) from the pool.</p><p>This function provides a thread-safe way to check how many resources are currently in use (taken) from the pool.  It does <em>not</em> include resources that are free and available for immediate acquisition.</p><p><strong>Arguments</strong></p><ul><li><code>pool::Pool{T}</code>: The resource pool to query.</li></ul><p><strong>Returns</strong></p><p>The number of taken resources in the pool.</p><p><strong>Thread Safety</strong></p><p>This operation is thread-safe.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">using Pools

create(::Type{Int}) = rand(1:10)

pool = Pool{Int}(3)
taken(pool)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AbrJA/Pools.jl/blob/77ceaffae95bac187384efe9d8121517786757f1/src/Pools.jl#L249-L278">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Pools.update!-Tuple{T} where T" href="#Pools.update!-Tuple{T} where T"><code>Pools.update!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>update!(resource::T) where T</p><p>Refresh the state of a resource of type <code>T</code> during releasing before it is reused.</p><p>This function is called automatically by the pool when a resource is returned to the pool via <code>release!</code>.  It provides an opportunity to update the resource&#39;s internal state, such as resetting connection parameters, updating timestamps, etc.</p><p>You <em>should</em> implement this method if your resource requires any state updates before it can be reused.  If no update is needed, you can leave this method unimplemented, and the default implementation will do nothing.</p><p><strong>Arguments</strong></p><ul><li><code>resource::T</code>: The resource to update.</li></ul><p><strong>Generic Method</strong></p><p>A generic <code>update!(::T) where T</code> method is provided, which does nothing. This serves as a default implementation so that if you do not define a specific <code>update!</code> method for your resource type. However, it is <em>strongly recommended</em> that you implement a specific <code>update!</code> method if your resource requires any state updates.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">using Pools, Redis, Dates
import Pools: create, update!

mutable struct Connection
    client::RedisConnection
    timestamp::DateTime
end

function update!(redis::Connection)
    redis.timestamp = now()
end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AbrJA/Pools.jl/blob/77ceaffae95bac187384efe9d8121517786757f1/src/Pools.jl#L80-L112">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Pools.validate-Tuple{T} where T" href="#Pools.validate-Tuple{T} where T"><code>Pools.validate</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>validate(resource::T) where T</p><p>Check the validity of a resource of type <code>T</code>.</p><p>This function is called automatically by the pool during resource acquisition (<code>acquire!</code>).  If <code>validate</code> fails, the resource is considered invalid, and the pool will attempt to create a new resource (or retrieve another free resource).  It is essential to implement this method to ensure that the pool only provides valid resources to users.</p><p><strong>Arguments</strong></p><ul><li><code>resource::T</code>: The resource to validate.</li></ul><p><strong>Generic Method</strong></p><p>A generic <code>validate(::T) where T</code> method is provided, which does nothing.  This means that if you do not define a specific <code>validate</code> method for your resource type, all resources will be considered valid.  While this might seem convenient, it is <em>strongly recommended</em> that you implement a specific <code>validate</code> method that performs appropriate checks for your resource type.  Relying on the generic method without proper validation can lead to unexpected errors and resource leaks.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">using Pools, Redis, Dates
import Pools: create, validate

struct Connection
    client::RedisConnection
    timestamp::DateTime
end

function validate(redis::Connection)
    ping(redis.client)
end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AbrJA/Pools.jl/blob/77ceaffae95bac187384efe9d8121517786757f1/src/Pools.jl#L115-L145">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Pools.withresource-Tuple{Any, Pool}" href="#Pools.withresource-Tuple{Any, Pool}"><code>Pools.withresource</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>withresource(f::Function, pool::Pool{T}) where T</p><p>Execute a function with a resource from the pool, automatically handling acquisition and release.</p><p>This function provides a safe and convenient way to use resources from the pool.  It acquires a resource, passes it to the provided function <code>f</code>, and <em>guarantees</em> that the resource is released back to the pool, even if an error occurs within the function.  This is the <em>recommended</em> way to work with pooled resources, as it prevents resource leaks and simplifies resource management.</p><p><strong>Arguments</strong></p><ul><li><code>f::Function</code>: A function that accepts a resource of type <code>T</code> as its argument. This function performs the operations you want to do with the resource.</li><li><code>pool::Pool{T}</code>: The resource pool to acquire the resource from.</li></ul><p><strong>Returns</strong></p><p>The value returned by the function <code>f</code>.</p><p><strong>Throws</strong></p><ul><li>Exceptions thrown by the function <code>f</code>.  These exceptions will be propagated after the resource is released.</li><li><code>MethodError</code>: If the <code>create(::Type{T})</code> or <code>validate(resource::T)</code> functions are not implemented for the resource type <code>T</code>.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">
using Redis, Dates

struct Connection
    client::RedisConnection
    timestamp::DateTime
end

create(::Type{Connection}) = Connection(RedisConnection(host = &quot;localhost&quot;, port = 6379, db = 3), now())

pool = Pool{Connection}(3)

withresource(pool) do redis
    ping(redis.client)
end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AbrJA/Pools.jl/blob/77ceaffae95bac187384efe9d8121517786757f1/src/Pools.jl#L436-L476">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="examples.html">« Examples</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Thursday 27 February 2025 13:56">Thursday 27 February 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
